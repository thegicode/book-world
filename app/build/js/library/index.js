"use strict";(()=>{var te=Object.defineProperty,ie=Object.defineProperties;var re=Object.getOwnPropertyDescriptors;var J=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var Z=(c,e,t)=>e in c?te(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t,E=(c,e)=>{for(var t in e||(e={}))se.call(e,t)&&Z(c,t,e[t]);if(J)for(var t of J(e))oe.call(e,t)&&Z(c,t,e[t]);return c},Q=(c,e)=>ie(c,re(e));var k=(c,e,t)=>new Promise((o,n)=>{var d=v=>{try{g(t.next(v))}catch(L){n(L)}},h=v=>{try{g(t.throw(v))}catch(L){n(L)}},g=v=>v.done?o(v.value):Promise.resolve(v.value).then(d,h);g((t=t.apply(c,e)).next())});var q="BookWorld";var f=class{constructor(){this.subscribers=[]}subscribe(e){this.subscribers.push(e)}unsubscribe(e){this.subscribers=this.subscribers.filter(t=>t!==e)}notify(e){this.subscribers.forEach(t=>t(e))}};var _=class{constructor(e,t){this.categoriesUpdatePublisher=new f;this.bookUpdatePublisher=new f;this._favorites=e||{},this._sortedKeys=t||[]}get favorites(){return E({},this._favorites)}set favorites(e){this._favorites=e}get sortedKeys(){return[...this._sortedKeys]}set sortedKeys(e){this._sortedKeys=e}add(e){this._favorites[e]=[],this.categoriesUpdatePublisher.notify({type:"add",payload:{name:e}})}addSortedKeys(e){this._sortedKeys.push(e)}rename(e,t){e in this._favorites&&(this._favorites[t]=this._favorites[e],delete this._favorites[e],this.categoriesUpdatePublisher.notify({type:"rename",payload:{prevName:e,newName:t}}))}renameSortedKeys(e,t){let o=this._sortedKeys.indexOf(e);o!==-1&&(this._sortedKeys[o]=t)}change(e,t){let o=this._sortedKeys.indexOf(e),n=this._sortedKeys.indexOf(t);this._sortedKeys[n]=e,this._sortedKeys[o]=t,this.categoriesUpdatePublisher.notify({type:"change",payload:{targetIndex:n,draggedIndex:o}})}delete(e){delete this._favorites[e],this.categoriesUpdatePublisher.notify({type:"delete",payload:{name:e}})}deleteSortedKeys(e){let t=this._sortedKeys.indexOf(e);return this._sortedKeys.splice(t,1),t}has(e){return e in this._favorites}addBook(e,t){e in this._favorites&&this._favorites[e].unshift(t),this.bookUpdatePublisher.notify()}hasBook(e,t){return e in this._favorites&&this._favorites[e].includes(t)}removeBook(e,t){if(e in this._favorites){let o=this._favorites[e].indexOf(t);o!=-1&&this._favorites[e].splice(o,1)}this.bookUpdatePublisher.notify()}subscribeCategoriesUpdate(e){this.categoriesUpdatePublisher.subscribe(e)}unsubscribeCategoriesUpdate(e){this.categoriesUpdatePublisher.unsubscribe(e)}subscribeBookUpdate(e){this.bookUpdatePublisher.subscribe(e)}unsubscribeBookUpdate(e){this.bookUpdatePublisher.unsubscribe(e)}};var w=class{constructor(e){this.publisher=new f;this._libraries=e}get libraries(){return E({},this._libraries)}set libraries(e){this._libraries=e}add(e,t){this._libraries[e]=t,this.publisher.notify({type:"add",payload:{code:e,name:t}})}remove(e){delete this._libraries[e],this.publisher.notify({type:"delete",payload:{code:e}})}has(e){return e in this._libraries}subscribeUpdate(e){this.publisher.subscribe(e)}unsubscribeUpdate(e){this.publisher.subscribe(e)}};var x=class{constructor(e){this.updatePublisher=new f;this.detailUpdatePublisher=new f;this._regions=e}get regions(){return E({},this._regions)}set regions(e){this._regions=e}add(e){this._regions[e]={},this.updatePublisher.notify()}remove(e){delete this._regions[e],this.updatePublisher.notify()}addDetail(e,t,o){e in this._regions&&(this._regions[e][t]=o),this.detailUpdatePublisher.notify()}removeDetail(e,t){e in this._regions&&t in this._regions[e]&&delete this._regions[e][t],this.detailUpdatePublisher.notify()}subscribeUpdatePublisher(e){this.updatePublisher.subscribe(e)}unsubscribeUpdatePublisher(e){this.updatePublisher.unsubscribe(e)}subscribeDetailUpdatePublisher(e){this.detailUpdatePublisher.subscribe(e)}unsubscribeDetailUpdatePublisher(e){this.detailUpdatePublisher.unsubscribe(e)}};var ne=c=>JSON.parse(JSON.stringify(c)),X={favorites:{},sortedFavoriteKeys:[],libraries:{},regions:{}},A=class{constructor(){this.bookStateUpdatePublisher=new f;let e=this.loadStorage()||ne(X),{favorites:t,sortedFavoriteKeys:o,libraries:n,regions:d}=e;this.favoriteModel=new _(t,o),this.libraryModel=new w(n),this.regionModel=new x(d)}loadStorage(){let e=localStorage.getItem(q);return e?JSON.parse(e):null}setStorage(e){try{localStorage.setItem(q,JSON.stringify(e))}catch(t){console.error(t)}}get state(){return this.loadStorage()}set state(e){this.setStorage(e);let{favorites:t,sortedFavoriteKeys:o,libraries:n,regions:d}=e;this.favoriteModel.favorites=t,this.favoriteModel.sortedKeys=o,this.libraryModel.libraries=n,this.regionModel.regions=d,this.bookStateUpdatePublisher.notify(),console.log("set state")}get favorites(){return this.favoriteModel.favorites}get sortedFavoriteKeys(){return this.favoriteModel.sortedKeys}get libraries(){return this.libraryModel.libraries}get regions(){return this.regionModel.regions}resetState(){this.state=X}setFavorites(){let e=this.state;e.favorites=this.favorites,e.sortedFavoriteKeys=this.sortedFavoriteKeys,this.setStorage(e)}addfavorite(e){this.favoriteModel.add(e),this.favoriteModel.addSortedKeys(e),this.setFavorites()}renameFavorite(e,t){this.favoriteModel.rename(e,t),this.setFavorites()}renameSortedFavoriteKey(e,t){this.favoriteModel.renameSortedKeys(e,t),this.setFavorites()}deleteFavorite(e){this.favoriteModel.delete(e),this.setFavorites()}deleteSortedFavoriteKey(e){let t=this.favoriteModel.deleteSortedKeys(e);return this.setFavorites(),t}hasFavorite(e){return this.favoriteModel.has(e)}changeFavorite(e,t){this.favoriteModel.change(e,t),this.setFavorites()}addFavoriteBook(e,t){this.favoriteModel.addBook(e,t),this.setFavorites()}hasFavoriteBook(e,t){return this.favoriteModel.hasBook(e,t)}removeFavoriteBook(e,t){this.favoriteModel.removeBook(e,t),this.setFavorites()}setLibraries(){let e=this.state;e.libraries=this.libraries,this.setStorage(e)}addLibraries(e,t){this.libraryModel.add(e,t),this.setLibraries()}removeLibraries(e){this.libraryModel.remove(e),this.setLibraries()}hasLibrary(e){return this.libraryModel.has(e)}setRegions(){let e=this.state;e.regions=this.regions,this.setStorage(e)}addRegion(e){this.regionModel.add(e),this.setRegions()}removeRegion(e){this.regionModel.remove(e),this.setRegions()}addDetailRegion(e,t,o){this.regionModel.addDetail(e,t,o),this.setRegions()}removeDetailRegion(e,t){this.regionModel.removeDetail(e,t),this.setRegions()}subscribeToBookStateUpdate(e){this.bookStateUpdatePublisher.subscribe(e)}unsubscribeToBookStateUpdate(e){this.bookStateUpdatePublisher.unsubscribe(e)}subscribeFavoriteCategoriesUpdate(e){this.favoriteModel.subscribeCategoriesUpdate(e)}unsubscribeFavoriteCategoriesUpdate(e){this.favoriteModel.unsubscribeCategoriesUpdate(e)}subscribeFavoriteBookUpdate(e){this.favoriteModel.subscribeBookUpdate(e)}unsubscribeFavoriteBookUpdate(e){this.favoriteModel.unsubscribeBookUpdate(e)}subscribeLibraryUpdate(e){this.libraryModel.subscribeUpdate(e)}unsubscribeLibraryUpdate(e){this.libraryModel.unsubscribeUpdate(e)}subscribeRegionUpdate(e){this.regionModel.subscribeUpdatePublisher(e)}unsubscribeRegionUpdate(e){this.regionModel.unsubscribeUpdatePublisher(e)}subscribeDetailRegionUpdate(e){this.regionModel.subscribeDetailUpdatePublisher(e)}unsubscribeDetailRegionUpdate(e){this.regionModel.unsubscribeDetailUpdatePublisher(e)}},ae=new A,u=ae;var K=class{constructor(){this._bus=document.createElement("div")}add(e,t){this._bus.addEventListener(e,t)}remove(e,t){this._bus.removeEventListener(e,t)}dispatch(e,t={}){this._bus.dispatchEvent(new CustomEvent(e,{detail:t}))}},le=new K;var V=class{constructor(e={}){this.defaultOptions=E({method:"GET",headers:{"Content-Type":"application/json"}},e)}fetch(e,t){return k(this,null,function*(){let o=Q(E(E({},this.defaultOptions),t),{timeout:5e3});try{let n=yield fetch(e,o);if(!n.ok)throw new Error(`Http error! status: ${n.status}, message: ${n.statusText}`);return yield n.json()}catch(n){throw console.error(`Error fetching data: ${n}`),new Error(`Error fetching data: ${n}`)}})}},P=new V;(function(){"use strict";if(typeof window!="object")return;if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype){"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});return}function c(i){try{return i.defaultView&&i.defaultView.frameElement||null}catch(r){return null}}var e=function(i){for(var r=i,s=c(r);s;)r=s.ownerDocument,s=c(r);return r}(window.document),t=[],o=null,n=null;function d(i){this.time=i.time,this.target=i.target,this.rootBounds=D(i.rootBounds),this.boundingClientRect=D(i.boundingClientRect),this.intersectionRect=D(i.intersectionRect||M()),this.isIntersecting=!!i.intersectionRect;var r=this.boundingClientRect,s=r.width*r.height,a=this.intersectionRect,l=a.width*a.height;s?this.intersectionRatio=Number((l/s).toFixed(4)):this.intersectionRatio=this.isIntersecting?1:0}function h(i,r){var s=r||{};if(typeof i!="function")throw new Error("callback must be a function");if(s.root&&s.root.nodeType!=1&&s.root.nodeType!=9)throw new Error("root must be a Document or Element");this._checkForIntersections=v(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT),this._callback=i,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(s.rootMargin),this.thresholds=this._initThresholds(s.threshold),this.root=s.root||null,this.rootMargin=this._rootMarginValues.map(function(a){return a.value+a.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}h.prototype.THROTTLE_TIMEOUT=100,h.prototype.POLL_INTERVAL=null,h.prototype.USE_MUTATION_OBSERVER=!0,h._setupCrossOriginUpdater=function(){return o||(o=function(i,r){!i||!r?n=M():n=$(i,r),t.forEach(function(s){s._checkForIntersections()})}),o},h._resetCrossOriginUpdater=function(){o=null,n=null},h.prototype.observe=function(i){var r=this._observationTargets.some(function(s){return s.element==i});if(!r){if(!(i&&i.nodeType==1))throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:i,entry:null}),this._monitorIntersections(i.ownerDocument),this._checkForIntersections()}},h.prototype.unobserve=function(i){this._observationTargets=this._observationTargets.filter(function(r){return r.element!=i}),this._unmonitorIntersections(i.ownerDocument),this._observationTargets.length==0&&this._unregisterInstance()},h.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},h.prototype.takeRecords=function(){var i=this._queuedEntries.slice();return this._queuedEntries=[],i},h.prototype._initThresholds=function(i){var r=i||[0];return Array.isArray(r)||(r=[r]),r.sort().filter(function(s,a,l){if(typeof s!="number"||isNaN(s)||s<0||s>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return s!==l[a-1]})},h.prototype._parseRootMargin=function(i){var r=i||"0px",s=r.split(/\s+/).map(function(a){var l=/^(-?\d*\.?\d+)(px|%)$/.exec(a);if(!l)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(l[1]),unit:l[2]}});return s[1]=s[1]||s[0],s[2]=s[2]||s[0],s[3]=s[3]||s[1],s},h.prototype._monitorIntersections=function(i){var r=i.defaultView;if(r&&this._monitoringDocuments.indexOf(i)==-1){var s=this._checkForIntersections,a=null,l=null;this.POLL_INTERVAL?a=r.setInterval(s,this.POLL_INTERVAL):(L(r,"resize",s,!0),L(i,"scroll",s,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in r&&(l=new r.MutationObserver(s),l.observe(i,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))),this._monitoringDocuments.push(i),this._monitoringUnsubscribes.push(function(){var m=i.defaultView;m&&(a&&m.clearInterval(a),z(m,"resize",s,!0)),z(i,"scroll",s,!0),l&&l.disconnect()});var p=this.root&&(this.root.ownerDocument||this.root)||e;if(i!=p){var b=c(i);b&&this._monitorIntersections(b.ownerDocument)}}},h.prototype._unmonitorIntersections=function(i){var r=this._monitoringDocuments.indexOf(i);if(r!=-1){var s=this.root&&(this.root.ownerDocument||this.root)||e,a=this._observationTargets.some(function(b){var m=b.element.ownerDocument;if(m==i)return!0;for(;m&&m!=s;){var y=c(m);if(m=y&&y.ownerDocument,m==i)return!0}return!1});if(!a){var l=this._monitoringUnsubscribes[r];if(this._monitoringDocuments.splice(r,1),this._monitoringUnsubscribes.splice(r,1),l(),i!=s){var p=c(i);p&&this._unmonitorIntersections(p.ownerDocument)}}}},h.prototype._unmonitorAllIntersections=function(){var i=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var r=0;r<i.length;r++)i[r]()},h.prototype._checkForIntersections=function(){if(!(!this.root&&o&&!n)){var i=this._rootIsInDom(),r=i?this._getRootRect():M();this._observationTargets.forEach(function(s){var a=s.element,l=B(a),p=this._rootContainsTarget(a),b=s.entry,m=i&&p&&this._computeTargetAndRootIntersection(a,l,r),y=null;this._rootContainsTarget(a)?(!o||this.root)&&(y=r):y=M();var T=s.entry=new d({time:g(),target:a,boundingClientRect:l,rootBounds:y,intersectionRect:m});b?i&&p?this._hasCrossedThreshold(b,T)&&this._queuedEntries.push(T):b&&b.isIntersecting&&this._queuedEntries.push(T):this._queuedEntries.push(T)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},h.prototype._computeTargetAndRootIntersection=function(i,r,s){if(window.getComputedStyle(i).display!="none"){for(var a=r,l=O(i),p=!1;!p&&l;){var b=null,m=l.nodeType==1?window.getComputedStyle(l):{};if(m.display=="none")return null;if(l==this.root||l.nodeType==9)if(p=!0,l==this.root||l==e)o&&!this.root?!n||n.width==0&&n.height==0?(l=null,b=null,a=null):b=n:b=s;else{var y=O(l),T=y&&B(y),G=y&&this._computeTargetAndRootIntersection(y,T,s);T&&G?(l=y,b=$(T,G)):(l=null,a=null)}else{var Y=l.ownerDocument;l!=Y.body&&l!=Y.documentElement&&m.overflow!="visible"&&(b=B(l))}if(b&&(a=ee(b,a)),!a)break;l=l&&O(l)}return a}},h.prototype._getRootRect=function(){var i;if(this.root&&!W(this.root))i=B(this.root);else{var r=W(this.root)?this.root:e,s=r.documentElement,a=r.body;i={top:0,left:0,right:s.clientWidth||a.clientWidth,width:s.clientWidth||a.clientWidth,bottom:s.clientHeight||a.clientHeight,height:s.clientHeight||a.clientHeight}}return this._expandRectByRootMargin(i)},h.prototype._expandRectByRootMargin=function(i){var r=this._rootMarginValues.map(function(a,l){return a.unit=="px"?a.value:a.value*(l%2?i.width:i.height)/100}),s={top:i.top-r[0],right:i.right+r[1],bottom:i.bottom+r[2],left:i.left-r[3]};return s.width=s.right-s.left,s.height=s.bottom-s.top,s},h.prototype._hasCrossedThreshold=function(i,r){var s=i&&i.isIntersecting?i.intersectionRatio||0:-1,a=r.isIntersecting?r.intersectionRatio||0:-1;if(s!==a)for(var l=0;l<this.thresholds.length;l++){var p=this.thresholds[l];if(p==s||p==a||p<s!=p<a)return!0}},h.prototype._rootIsInDom=function(){return!this.root||j(e,this.root)},h.prototype._rootContainsTarget=function(i){var r=this.root&&(this.root.ownerDocument||this.root)||e;return j(r,i)&&(!this.root||r==i.ownerDocument)},h.prototype._registerInstance=function(){t.indexOf(this)<0&&t.push(this)},h.prototype._unregisterInstance=function(){var i=t.indexOf(this);i!=-1&&t.splice(i,1)};function g(){return window.performance&&performance.now&&performance.now()}function v(i,r){var s=null;return function(){s||(s=setTimeout(function(){i(),s=null},r))}}function L(i,r,s,a){typeof i.addEventListener=="function"?i.addEventListener(r,s,a||!1):typeof i.attachEvent=="function"&&i.attachEvent("on"+r,s)}function z(i,r,s,a){typeof i.removeEventListener=="function"?i.removeEventListener(r,s,a||!1):typeof i.detachEvent=="function"&&i.detachEvent("on"+r,s)}function ee(i,r){var s=Math.max(i.top,r.top),a=Math.min(i.bottom,r.bottom),l=Math.max(i.left,r.left),p=Math.min(i.right,r.right),b=p-l,m=a-s;return b>=0&&m>=0&&{top:s,bottom:a,left:l,right:p,width:b,height:m}||null}function B(i){var r;try{r=i.getBoundingClientRect()}catch(s){}return r?(r.width&&r.height||(r={top:r.top,right:r.right,bottom:r.bottom,left:r.left,width:r.right-r.left,height:r.bottom-r.top}),r):M()}function M(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function D(i){return!i||"x"in i?i:{top:i.top,y:i.top,bottom:i.bottom,left:i.left,x:i.left,right:i.right,width:i.width,height:i.height}}function $(i,r){var s=r.top-i.top,a=r.left-i.left;return{top:s,left:a,height:r.height,width:r.width,bottom:s+r.height,right:a+r.width}}function j(i,r){for(var s=r;s;){if(s==i)return!0;s=O(s)}return!1}function O(i){var r=i.parentNode;return i.nodeType==9&&i!=e?c(i):(r&&r.assignedSlot&&(r=r.assignedSlot.parentNode),r&&r.nodeType==11&&r.host?r.host:r)}function W(i){return i&&i.nodeType===9}window.IntersectionObserver=h,window.IntersectionObserverEntry=d})();var C=class extends HTMLElement{constructor(){super();this.sizeElement=null;this.PATHS=["/search","/favorite","/popular","/library","/setting"],this.sizeElement=null,this.renderBookSize=this.renderBookSize.bind(this)}connectedCallback(){this.render(),this.setSelectedMenu(),this.sizeElement=this.querySelector(".size"),u.subscribeFavoriteBookUpdate(this.renderBookSize),u.subscribeToBookStateUpdate(this.renderBookSize)}disconnectedCallback(){u.unsubscribeFavoriteBookUpdate(this.renderBookSize),u.unsubscribeFavoriteBookUpdate(this.renderBookSize)}get bookSize(){return Object.values(u.favorites).reduce((t,o)=>t+o.length,0)}render(){this.innerHTML=`
            <nav class="gnb">
                <a class="gnb-item" href=".${this.PATHS[0]}">\uCC45 \uAC80\uC0C9</a>
                <a class="gnb-item" href=".${this.PATHS[1]}">\uB098\uC758 \uCC45 (<span class="size">${this.bookSize}</span>)</a>
                <a class="gnb-item" href=".${this.PATHS[2]}">\uC778\uAE30\uB300\uCD9C\uB3C4\uC11C</a>
                <a class="gnb-item" href=".${this.PATHS[3]}">\uB3C4\uC11C\uAD00 \uC870\uD68C</a>
                <a class="gnb-item" href=".${this.PATHS[4]}">\uC124\uC815</a>
            </nav>`}setSelectedMenu(){let t=this.PATHS.indexOf(document.location.pathname);t>=0&&(this.querySelectorAll("a")[t].ariaSelected="true")}renderBookSize(){this.sizeElement&&(this.sizeElement.textContent=this.bookSize.toString())}};var I=class extends HTMLElement{constructor(){super()}show(){this.removeAttribute("hidden")}hide(){this.setAttribute("hidden","")}};customElements.define("loading-component",I);function S(c){let e=c.content.firstElementChild;if(!e)throw new Error("Template content is empty");return e.cloneNode(!0)}var U=class extends HTMLElement{constructor(){super();this._regionCode=null;this.PAGE_SIZE=20;this.listElement=this.querySelector(".library-list"),this.itemTemplate=document.querySelector("#tp-item"),this.loadingComponent=this.querySelector("loading-component")}set regionCode(t){this._regionCode=t,this.handleRegionCodeChange()}get regionCode(){return this._regionCode}connectedCallback(){}handleRegionCodeChange(){this.regionCode&&this.fetchLibrarySearch(this.regionCode)}fetchLibrarySearch(t){return k(this,null,function*(){var n,d;this.listElement&&(this.listElement.innerHTML=""),(n=this.loadingComponent)==null||n.show();let o=`/library-search?dtl_region=${t}&page=1&pageSize=${this.PAGE_SIZE}`;try{let h=yield P.fetch(o);this.renderLibraryList(h)}catch(h){throw console.error(h),new Error("Fail to get library search data.")}(d=this.loadingComponent)==null||d.hide()})}renderLibraryList(t){if(!this.listElement)return;let{libraries:o}=t;if(o.length===0){this.showMessage("notFound");return}let n=o.reduce((d,h)=>this.createLibraryItem(d,h),new DocumentFragment);this.listElement.appendChild(n)}createLibraryItem(t,o){let n=S(this.itemTemplate);return n.data=o,u.hasLibrary(o.libCode)?(n.dataset.has="true",t.prepend(n)):t.appendChild(n),t}showMessage(t){let o=document.querySelector(`#tp-${t}`);if(o&&this.listElement){this.listElement.innerHTML="";let n=S(o);this.listElement.appendChild(n)}}};var H=class extends HTMLElement{constructor(){super();this.template=null;this.listElement=null;this.subscribeUpdate=this.subscribeUpdate.bind(this)}connectedCallback(){this.template=this.querySelector("#tp-stored-item"),console.log(this.template),this.listElement=this.querySelector("ul"),this.listElement&&(this.render(),u.subscribeLibraryUpdate(this.subscribeUpdate))}disconnectedCallback(){u.unsubscribeLibraryUpdate(this.subscribeUpdate)}render(){if(!this.listElement)return;let t=u.libraries,o=new DocumentFragment;for(let[n,d]of Object.entries(t)){let h=this.createElement(n,d);if(!h)return;o.appendChild(h)}this.listElement.appendChild(o)}createElement(t,o){if(!this.template)return;let n=S(this.template);return n.querySelector(".name").textContent=o,n.dataset.library=t,this.addEvents(n),n}addEvents(t){t.querySelector(".cancelButton").addEventListener("click",()=>{let n=t.dataset.library;n&&u.removeLibraries(n)})}subscribeUpdate({type:t,payload:o}){switch(t){case"add":this.add(o);break;case"delete":this.delete(o.code);break;default:console.error("Unknown type")}}add({code:t,name:o}){if(!this.listElement||!o)return;let n=this.createElement(t,o);this.listElement.appendChild(n)}delete(t){if(this.listElement)for(let o of this.listElement.querySelectorAll("li"))o.dataset.library===t&&o.remove()}};var N=document.querySelector("app-library"),bt=document.querySelector("loading-component");var F=class extends HTMLElement{constructor(){super();this.regionCode=null;this.template=null;this.handleDetailSelectChange=()=>{let{value:t}=this.detailSelectElement;N&&(N.regionCode=t)}}connectedCallback(){this.template=document.querySelector("#tp-region"),this.detailSelectElement=this.querySelector("select"),this.renderFavoriteRegions(),this.detailSelectElement.addEventListener("change",this.handleDetailSelectChange)}disconnectedCallback(){this.detailSelectElement.removeEventListener("change",this.handleDetailSelectChange)}renderFavoriteRegions(){let t=u.regions;if(Object.keys(t).length===0)return;let o=this.querySelector(".region"),n=new DocumentFragment;for(let d of Object.keys(t)){let h=Object.keys(t[d]).length;if(this.template&&h>0){let g=this.createElement(d);n.appendChild(g)}}if(o.appendChild(n),!this.regionCode){let d=o.querySelector("input");d.checked=!0,this.renderDetailRegion(d.value)}}createElement(t){if(!this.template)return;let o=S(this.template),n=o.querySelector("input");n.value=t,n.addEventListener("change",()=>this.handleRegionChange(n.value));let d=o.querySelector("span");return d.textContent=t,o}handleRegionChange(t){this.regionCode=t,this.renderDetailRegion(t)}renderDetailRegion(t){this.detailSelectElement.innerHTML="";let o=u.regions[t];for(let[d,h]of Object.entries(o)){let g=document.createElement("option");g.textContent=d,g.value=h,this.detailSelectElement.appendChild(g)}let n=this.detailSelectElement.querySelector("option");n.selected=!0,this.handleDetailSelectChange()}};var R=class extends HTMLElement{constructor(){super();this.checkbox=null;this.libCode="";this.libName="";this.checkbox=this.querySelector("[name=myLibrary]"),this.onChange=this.onChange.bind(this)}connectedCallback(){var t;this.render(),(t=this.checkbox)==null||t.addEventListener("click",this.onChange)}disconnectedCallback(){var t;(t=this.checkbox)==null||t.removeEventListener("click",this.onChange)}render(){let{data:t}=this;if(t===null)return;let{libCode:o,libName:n}=t;this.libCode=o,this.libName=n,Object.entries(t).forEach(([h,g])=>{let v=this.querySelector(`.${h}`);v&&(v.innerHTML=g)});let d=this.querySelector(".homepage");d&&(d.href=t.homepage),this.checkbox&&(this.checkbox.checked=u.hasLibrary(o))}onChange(){var t;(t=this.checkbox)!=null&&t.checked?u.addLibraries(this.libCode,this.libName):u.removeLibraries(this.libCode)}};customElements.define("nav-gnb",C);customElements.define("app-library",U);customElements.define("library-stored",H);customElements.define("library-header",F);customElements.define("library-item",R);})();
